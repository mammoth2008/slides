    <!doctype html>
    <html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=1024" />
        <meta name="apple-mobile-web-app-capable" content="yes" />

<!-- 修改页面标题 -->
        <title>DB & DS | HUST</title>

<!-- 修改 content -->
        <meta name="description" content="数据库与数据结构课程使用, 为哈尔滨理工大学经济管理学院信息管理与信息系统专业设计. " />
        <meta name="author" content="xinjiang@hrbust.edu.cn" />

<!-- 引入数学公式 -->
        <script type="text/javascript">
            window.MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
              },
              chtml: {
                scale: 0.95
              }
            };
        </script>
        <script src="../extras/mathjax/tex-chtml-full.js"></script>
<!-- 引入完毕 -->

        <link href="../css/impress-course.css" rel="stylesheet" />
        <link href="../css/impress-common.css" rel="stylesheet" />

        <link rel="shortcut icon" href="../hustlogo72.png" />
        <link rel="stylesheet" href="../extras/highlight/styles/github.css">

    </head>

    <body class="impress-not-supported">

<!-- 左上角加上 logo -->
    <div class="logo"></div>

    <div class="fallback-message">
        <p>你的浏览器不支持本网站所要求的功能, 现在看到的是本网站简化版本.</p>
        <p>为了获得最佳体验, 请使用最新的Chrome, Safari, Firefox 或 Edge 浏览器.</p>

    </div>

    <div 
    id                       = "impress" 
    data-transition-duration = "1000" 
    data-width               = "1024" 
    data-height              = "768" 
    data-max-scale           = "3" 
    data-min-scale           = "0" 
    data-perspective         = "1000" 
    data-autoplay            = "0">

<!-- 每一节 slide 的标题是 cxyt", 表示章节标题. 如第一章第一节标题就是 c11t, 第三章第二节标题就是 c32t -->
<!-- 每一节 slide 的标题页 class 应该是 step, 不是 step markdown -->
<!-- 类似地, 需要 HTML 排版的 slide,class 都是 step; 可以使用 markdown 的, class 才是 step markdown -->

    <div 
    id         = "overview" 
    data-x     = "0" 
    data-y     = "0" 
    class      = "step" 
    data-scale = "10">

    </div>

<!-- 修改 id -->

    <div 
    id         = "c62t"
    class      = "step"
    data-x     = "0"
    data-y     = "0"
    data-z     = "0"
    data-scale = "5">

    <!-- 修改标题 -->
        <h2>6. 数据库保护</h2>
        <h3 style="text-align: center">6.2 数据库完整性</h3>
        <p class="footnote">
            <inlinecode style="font-size: 16px">
            Powered by 
            </inlinecode>
                <a href="https://github.com/impress/impress.js/">
                    <inlinecode style="font-size: 16px">
                    impress.js
                    </inlinecode>
                    <img class="icon" src="../favicon.png" style="width:10px;height:10px;">
                </a>
                <br/>
                <inlinecode style="font-size: 16px">
                    Ver. 2408
                </inlinecode>
            </inlinecode>
        </p>

    </div>
        
    <div 
    id            = "a1"
    class         = "step markdown"
    data-rel-to   = "c62t"
    data-rel-x    = "-2000"
    data-rel-y    = "-2000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 数据库的完整性

- 数据的正确性: 数据符合现实世界的语义
- 数据的相容性: 同一对象在不同表中的数据符合逻辑
- 旨在防止数据库中存在不符合语义的数据

    </div>

    <div 
    id            = "a2"
    class         = "step markdown"
    data-rel-to   = "a1"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 维护数据库完整性

- 提供定义完整性约束条件的机制
- 提供完整性检查的方法
- 进行违约处理

    </div>

    <div 
    id            = "a3"
    class         = "step markdown"
    data-rel-to   = "a2"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 完整性检查

- 耗费时间和资源
- 由数据库管理系统实现

    </div>

    <div 
    id            = "a4"
    class         = "step markdown"
    data-rel-to   = "a3"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 数据库完整性

- 实体完整性
- 参照完整性
- 用户定义的完整性

    </div>

    <div 
    id            = "a5"
    class         = "step markdown"
    data-rel-to   = "a4"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 实体完整性

- 在 CREATE TABLE 语句中使用 PRIMARY KEY 短语
- 在列级别定义约束条件
- 在表级别定义约束条件

    </div>

    <div 
    id            = "a6"
    class         = "step markdown"
    data-rel-to   = "a5"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 实体完整性检查

- 主码值是否唯一
- 主码的各个属性是否为空
- 通常会在主码上自动创建索引

    </div>

    <div 
    id            = "a7"
    class         = "step markdown"
    data-rel-to   = "c62t"
    data-rel-x    = "0"
    data-rel-y    = "-2000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 参照完整性

- 在 CREATE TABLE 语句中使用 FOREIGN KEY 和 REFERENCES 短语
- FOREIGN KEY 指明哪些列是外码
- REFERENCES 指明外码参照了哪些表的主码

    </div>

    <div 
    id            = "a8"
    class         = "step markdown"
    data-rel-to   = "a7"
    data-rel-x    = "0"
    data-rel-y    = "3000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 例 3

    CREATE TABLE SC (
        Sno CHAR(9) NOT NULL,
        Cno CHAR(4) NOT NULL,
        Grade SMALLINT,
    PRIMARY KEY (Sno, Cno),
    FOREIGN KEY (Sno) REFERENCES Student(Sno),
    FOREIGN KEY (Cno) REFERENCES Course(Cno)
    );

    </div>

    <div 
    id            = "a9"
    class         = "step markdown"
    data-rel-to   = "a8"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 参照完整性检查

- 例如:
- 在 SC 表和 Student 表之间
- Student 删除元组
- Student 修改主码值
- SC 插入元组
- SC 修改外码值

    </div>

    <div 
    id            = "a10"
    class         = "step markdown"
    data-rel-to   = "a9"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 违约处理

- 拒绝 (NO ACTION) 执行
- 级联 (CASCADE) 操作
- 设置为空值

    </div>

    <div 
    id            = "a11"
    class         = "step markdown"
    data-rel-to   = "a10"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 参照完整性违约处理

- 例如:
- 在 SC 表和 Student 表之间
- Student 删除元组 拒绝/级联删除/设置为空值
- Student 修改主码值 拒绝/级联删除/设置为空值
- SC 插入元组 拒绝
- SC 修改外码值 拒绝

    </div>

    <div 
    id            = "a12"
    class         = "step markdown"
    data-rel-to   = "a11"
    data-rel-x    = "0"
    data-rel-y    = "1200"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 创建参照表时明确指定

    CREATE TABLE SC (
        Sno CHAR(9),
        Cno CHAR(4),
        Grade SMALLINT,
    PRIMARY KEY (Sno, Cno),
    FOREIGN KEY (Sno) REFERENCES Student(Sno)
    ON DELETE CASCADE ON UPDATE CASCADE,
    FOREIGN KEY (Cno) REFERENCES Course(Cno)
    ON DELETE NO ACTION ON UPDATE CASCADE
    );

    </div>

    <div 
    id            = "a13"
    class         = "step markdown"
    data-rel-to   = "c62t"
    data-rel-x    = "2000"
    data-rel-y    = "-2100"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 用户定义的完整性

- 针对特定应用中数据必须满足的语义要求
- DBMS 提供了定义和检验这类完整性的机制

    </div>

    <div 
    id            = "a14"
    class         = "step markdown"
    data-rel-to   = "a13"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 属性上的约束条件

- 在 CREATE TABLE 语句中定义
- 列值非空 (NOT NULL)
- 列值唯一 (UNIQUE)
- 检查列值是否满足条件表达式 (CHECK)

    </div>

    <div 
    id            = "a15"
    class         = "step markdown"
    data-rel-to   = "a14"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 例 8 改

    CREATE TABLE SC (
        Sno CHAR(9) NOT NULL,
        Cno CHAR(4) NOT NULL,
        Grade SMALLINT CHECK (Grade >= 0
                         AND Grade <= 100),
    PRIMARY KEY (Sno, Cno),
    FOREIGN KEY (Sno) REFERENCES Student(Sno),
    FOREIGN KEY (Cno) REFERENCES Course(Cno)
    );

    </div>

    <div 
    id            = "a16"
    class         = "step markdown"
    data-rel-to   = "a15"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 属性上约束条件的检查

- 在插入元组或修改属性值时检查
- 如不满足则拒绝执行

    </div>

    <div 
    id            = "a17"
    class         = "step markdown"
    data-rel-to   = "a16"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 元组上的约束条件

    CREATE TABLE Student (
        Sno CHAR(9),
        Sname CHAR(8) NOT NULL,
        Ssex CHAR(2),
        Sage SMALLINT,
        Sdept CHAR(20),
    PRIMARY KEY (Sno),
    CHECK (Ssex = '女' OR Sname NOT LIKE 'Ms.%')
    );

- 在CREATE TABLE语句中使用CHECK短语

    </div>

    <div 
    id            = "a18"
    class         = "step markdown"
    data-rel-to   = "a17"
    data-rel-x    = "0"
    data-rel-y    = "1000"
    data-rel-z    = "0"
    data-rotate-y = "0"
    data-scale    = "2">

### 元组上约束条件的检查

- 在插入元组或修改属性值时检查
- 如不满足则拒绝执行

    </div>

    <div
    id            = "mm62"
    class         = "step markdown"
    data-rel-to   = "c62t"
    data-rel-x    = "0"
    data-rel-y    = "-2000"
    data-rotate-y = "0"
    data-rotate   = "0"
    data-scale    = "1">

![course 6.2 mindmap](img/c06/mindmap-6-2.png)

    </div>

<!-- 本节问题 -->

    <div
    id            = "c62q"
    class         = "step markdown"
    data-rel-to   = "c62t"
    data-rel-x    = "0"
    data-rel-y    = "-800"
    data-z        = "500"
    data-rotate-x = "77"
    data-rotate-y = "0"
    data-rotate-z = "180"
    data-scale    = "2">

### 6.2 数据库完整性

- 什么是数据的正确性和数据的相容性?
- 哪些机制可以定义完整性约束条件?
- 实体完整性的检查主要关注什么方面?
- 参照完整性违约处理有哪几种方式?
- 用户定义的完整性与实体完整性和参照完整性有何不同?

----

[ 6.1 数据库安全性](dbds-6-1.html#/overview)
[| 练习 |](dbds-exec.html)
[ 6.3 数据库恢复](dbds-6-3.html#/overview)

    </div>

    </div>

    <!--
    <div id="impress-toolbar"></div>
    <div id="impress-help"></div>

    <script>
    if ("ontouchstart" in document.documentElement) { 
        document.querySelector(".hint").innerHTML = "<p>Swipe left or right to navigate</p>";
    }
    </script>
    -->

    <!-- 页面下方显示进度条 -->
    <div class="impress-progressbar">
        <div></div>
    </div>

    <!-- 页面下方显示当前页/总页数 -->
    <div class="impress-progress"></div>

    <!-- 使用 markdown 写简单页面 -->
    <script type="text/javascript" src="../extras/markdown/markdown.js"></script>

    <!-- 语法高亮,配合<head>中的 highlight css 起作用 -->
    <script src="../extras/highlight/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- impress.js 需要放在最下面,并且初始化 -->
    <script src="../js/impress.js"></script>
    <script>impress().init();</script>
    </body>
    </html>
